<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LSI Calculator</title>
<style>
  body {
    font-family: 'Segoe UI', Arial, sans-serif;
    margin: 0;
    padding: 20px;
    background: #eef7ff;
    color: #042a4a;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
  }
  .container {
    background: #ffffff;
    padding: 30px;
    border-radius: 12px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    max-width: 400px;
    width: 100%;
  }
  h2 {
    color: #0056b3;
    margin-bottom: 20px;
    border-bottom: 2px solid #0056b3;
    padding-bottom: 10px;
  }
  label { display: block; margin-top: 15px; font-weight: bold; color: #333; }
  input {
    width: 100%; padding: 10px; margin-top: 5px;
    border-radius: 6px; border: 1px solid #ccc;
    box-sizing: border-box; font-size: 1em;
  }
  .result-container {
    margin-top: 25px; padding: 18px;
    background: #f1f8ff;
    border-radius: 8px; border: 1px solid #cce5ff;
  }
  .result-item { margin-bottom: 10px; }
  .value { font-weight: bold; font-size: 1.6em; margin-left: 10px; }
  .interp { margin-top: 15px; padding: 10px; border-radius: 5px; font-weight: bold; text-align: center; }
  .interp.scaling { background-color: #cce5ff; color: #0056b3; }
  .interp.balanced { background-color: #d4edda; color: #28a745; }
  .interp.corrosive { background-color: #ffcccc; color: #d9534f; }
</style>
</head>
<body>

<div class="container">
<h2>LSI & RI Calculator</h2>

<form>
  <label for="ph">pH:</label>
  <input id="ph" type="number" step="0.01" oninput="calculateLSI()">

  <label for="conduct">Conductivity (µS/cm):</label>
  <div style="display: flex; gap: 10px;">
  <input id="conduct" type="number" oninput="updateAutoTDS(); calculateLSI();" placeholder="">
  <input id="factor" type="number" step="0.01" value="0.65" oninput="updateAutoTDS();" style="width: 80px;" title="Factor (เช่น 0.65)">
  </div>


  <!-- ✅ TDS Auto-Fill -->
  <label for="tds">TDS (ppm):</label>
<input id="tds" type="number" oninput="calculateLSI()">

  <label for="temp">Skin Temp (°C):</label>
  <input id="temp" type="number" oninput="calculateLSI()" value="60">

  <label for="ca">Calcium Hardness (ppm as CaCO₃):</label>
  <input id="ca" type="number" oninput="calculateLSI()">

  <label for="alk">M-Alkalinity (ppm as CaCO₃):</label>
  <input id="alk" type="number" oninput="calculateLSI()">
</form>

<div class="result-container">
  <div class="result-item">
    LSI: <span id="lsiValue" class="value">–</span>
  </div>
  <div class="result-item">
    RI: <span id="riValue" class="value">–</span>
  </div>
  <div class="interp" id="interp"></div>
</div>
<div style="text-align:center; margin-top:25px;">
  <a href="https://naninok.github.io/Main-Page/" 
     style= padding:10px 18px; border-radius:6px; text-decoration:none; font-weight:bold;">
     ⬅ กลับไปหน้าแรก
  </a>
</div>
</div>


<script>

// Tables taken from your Excel (LSI sheet)
const SOLIDS = [[50, 0.07],
 [75, 0.08],
 [100, 0.1],
 [150, 0.11],
 [200, 0.13],
 [300, 0.14],
 [400, 0.16],
 [600, 0.18],
 [800, 0.19],
 [1000, 0.2],
 [2000, 0.23],
 [3000, 0.25],
 [4000, 0.26],
 [5000, 0.27],
 [6000, 0.28]];
const TEMPERATURE = [[32, 2.6],
 [34, 2.57],
 [36, 2.54],
 [38, 2.51],
 [40, 2.48],
 [42, 2.45],
 [44, 2.43],
 [46, 2.4],
 [48, 2.37],
 [50, 2.34],
 [52, 2.31],
 [54, 2.28],
 [56, 2.25],
 [58, 2.22],
 [60, 2.2],
 [62, 2.17],
 [64, 2.14],
 [66, 2.11],
 [68, 2.09],
 [70, 2.06],
 [72, 2.04],
 [74, 2.03],
 [76, 2],
 [78, 1.97],
 [80, 1.95],
 [82, 1.92],
 [84, 1.9],
 [86, 1.88],
 [88, 1.86],
 [90, 1.84],
 [92, 1.82],
 [94, 1.8],
 [96, 1.78],
 [98, 1.76],
 [100, 1.74],
 [102, 1.72],
 [104, 1.71],
 [106, 1.69],
 [108, 1.67],
 [110, 1.65],
 [112, 1.64],
 [114, 1.62],
 [116, 1.6],
 [118, 1.58],
 [120, 1.57],
 [122, 1.55],
 [124, 1.53],
 [126, 1.51],
 [128, 1.5],
 [130, 1.48],
 [132, 1.46],
 [134, 1.44],
 [136, 1.43],
 [138, 1.41],
 [140, 1.4],
 [142, 1.38],
 [144, 1.37],
 [146, 1.35],
 [148, 1.34],
 [150, 1.32],
 [152, 1.31],
 [154, 1.29],
 [156, 1.28],
 [158, 1.27],
 [160, 1.26],
 [162, 1.24],
 [164, 1.23],
 [166, 1.22],
 [168, 1.21],
 [170, 1.19],
 [172, 1.18],
 [174, 1.17],
 [176, 1.16]];
const HARDNESS = [[3, 0.08],
 [4, 0.2],
 [5, 0.3],
 [6, 0.38],
 [7, 0.45],
 [8, 0.51],
 [9, 0.56],
 [10, 0.6],
 [11, 0.64],
 [12, 0.68],
 [13, 0.72],
 [14, 0.75],
 [15, 0.78],
 [16, 0.81],
 [17, 0.83],
 [18, 0.86],
 [19, 0.88],
 [20, 0.9],
 [21, 0.92],
 [22, 0.94],
 [23, 0.96],
 [24, 0.98],
 [25, 1],
 [26, 1.02],
 [27, 1.03],
 [28, 1.05],
 [29, 1.06],
 [30, 1.08],
 [31, 1.09],
 [32, 1.11],
 [33, 1.12],
 [34, 1.13],
 [35, 1.15],
 [36, 1.16],
 [37, 1.17],
 [38, 1.18],
 [39, 1.19],
 [40, 1.2],
 [41, 1.21],
 [42, 1.23],
 [43, 1.24],
 [44, 1.25],
 [45, 1.26],
 [46, 1.26],
 [47, 1.27],
 [48, 1.28],
 [49, 1.29],
 [50, 1.3],
 [51, 1.31],
 [52, 1.32],
 [53, 1.33],
 [54, 1.34],
 [55, 1.34],
 [56, 1.35],
 [57, 1.36],
 [58, 1.37],
 [59, 1.37],
 [60, 1.38],
 [61, 1.39],
 [62, 1.39],
 [63, 1.4],
 [64, 1.41],
 [65, 1.42],
 [66, 1.42],
 [67, 1.43],
 [68, 1.43],
 [69, 1.44],
 [70, 1.45],
 [71, 1.45],
 [72, 1.46],
 [73, 1.47],
 [74, 1.47],
 [75, 1.48],
 [76, 1.48],
 [77, 1.49],
 [78, 1.49],
 [79, 1.5],
 [80, 1.51],
 [81, 1.51],
 [82, 1.52],
 [83, 1.52],
 [84, 1.53],
 [85, 1.53],
 [86, 1.54],
 [87, 1.54],
 [88, 1.55],
 [89, 1.55],
 [90, 1.56],
 [91, 1.56],
 [92, 1.57],
 [93, 1.57],
 [94, 1.58],
 [95, 1.58],
 [96, 1.58],
 [97, 1.59],
 [98, 1.59],
 [99, 1.6],
 [100, 1.6],
 [101, 1.61],
 [102, 1.61],
 [103, 1.61],
 [104, 1.62],
 [105, 1.62],
 [106, 1.63],
 [107, 1.63],
 [108, 1.64],
 [109, 1.64],
 [110, 1.64],
 [111, 1.65],
 [112, 1.65],
 [113, 1.66],
 [114, 1.66],
 [115, 1.66],
 [116, 1.67],
 [117, 1.67],
 [118, 1.67],
 [119, 1.68],
 [120, 1.68],
 [121, 1.68],
 [122, 1.69],
 [123, 1.69],
 [124, 1.7],
 [125, 1.7],
 [126, 1.7],
 [127, 1.71],
 [128, 1.71],
 [129, 1.71],
 [130, 1.72],
 [131, 1.72],
 [132, 1.72],
 [133, 1.73],
 [134, 1.73],
 [135, 1.73],
 [136, 1.74],
 [137, 1.74],
 [138, 1.74],
 [139, 1.75],
 [140, 1.75],
 [141, 1.75],
 [142, 1.75],
 [143, 1.76],
 [144, 1.76],
 [145, 1.76],
 [146, 1.77],
 [147, 1.77],
 [148, 1.77],
 [149, 1.78],
 [150, 1.78],
 [151, 1.78],
 [152, 1.78],
 [153, 1.79],
 [154, 1.79],
 [155, 1.79],
 [156, 1.8],
 [157, 1.8],
 [158, 1.8],
 [159, 1.8],
 [160, 1.81],
 [161, 1.81],
 [162, 1.81],
 [163, 1.81],
 [164, 1.82],
 [165, 1.82],
 [166, 1.82],
 [167, 1.82],
 [168, 1.83],
 [169, 1.83],
 [170, 1.83],
 [171, 1.84],
 [172, 1.84],
 [173, 1.84],
 [174, 1.84],
 [175, 1.85],
 [176, 1.85],
 [177, 1.85],
 [178, 1.85],
 [179, 1.85],
 [180, 1.86],
 [181, 1.86],
 [182, 1.86],
 [183, 1.86],
 [184, 1.87],
 [185, 1.87],
 [186, 1.87],
 [187, 1.87],
 [188, 1.88],
 [189, 1.88],
 [190, 1.88],
 [191, 1.88],
 [192, 1.89],
 [193, 1.89],
 [194, 1.89],
 [195, 1.89],
 [196, 1.89],
 [197, 1.9],
 [198, 1.9],
 [199, 1.9],
 [200, 1.9],
 [201, 1.91],
 [202, 1.91],
 [203, 1.91],
 [204, 1.91],
 [205, 1.91],
 [206, 1.92],
 [207, 1.92],
 [208, 1.92],
 [209, 1.92],
 [210, 1.92],
 [220, 1.94],
 [230, 1.96],
 [240, 1.98],
 [250, 2],
 [260, 2.02],
 [270, 2.03],
 [280, 2.05],
 [290, 2.06],
 [300, 2.08],
 [310, 2.09],
 [320, 2.11],
 [330, 2.12],
 [340, 2.13],
 [350, 2.15],
 [360, 2.16],
 [370, 2.17],
 [380, 2.18],
 [390, 2.19],
 [400, 2.2],
 [410, 2.21],
 [420, 2.23],
 [430, 2.24],
 [440, 2.25],
 [450, 2.26],
 [460, 2.26],
 [470, 2.27],
 [480, 2.28],
 [490, 2.29],
 [500, 2.3],
 [510, 2.31],
 [520, 2.32],
 [530, 2.33],
 [540, 2.34],
 [550, 2.34],
 [560, 2.35],
 [570, 2.36],
 [580, 2.37],
 [590, 2.37],
 [600, 2.38],
 [610, 2.39],
 [620, 2.39],
 [630, 2.4],
 [640, 2.41],
 [650, 2.42],
 [660, 2.42],
 [670, 2.43],
 [680, 2.43],
 [690, 2.44],
 [700, 2.45],
 [710, 2.45],
 [720, 2.46],
 [730, 2.47],
 [740, 2.47],
 [750, 2.48],
 [760, 2.48],
 [770, 2.49],
 [780, 2.49],
 [790, 2.5],
 [800, 2.51],
 [810, 2.51],
 [820, 2.52],
 [830, 2.52],
 [840, 2.53],
 [850, 2.53],
 [860, 2.54],
 [870, 2.54],
 [880, 2.55],
 [890, 2.55],
 [900, 2.56],
 [910, 2.56],
 [920, 2.57],
 [930, 2.57],
 [940, 2.58],
 [950, 2.58],
 [960, 2.58],
 [970, 2.59],
 [980, 2.59],
 [990, 2.6]];
const ALKALINITY = [[1, 0],
 [2, 0.3],
 [3, 0.48],
 [4, 0.6],
 [5, 0.7],
 [6, 0.78],
 [7, 0.85],
 [8, 0.9],
 [9, 0.95],
 [10, 1],
 [11, 1.04],
 [12, 1.08],
 [13, 1.11],
 [14, 1.15],
 [15, 1.18],
 [16, 1.2],
 [17, 1.23],
 [18, 1.25],
 [19, 1.29],
 [20, 1.3],
 [21, 1.32],
 [22, 1.34],
 [23, 1.36],
 [24, 1.38],
 [25, 1.4],
 [26, 1.42],
 [27, 1.43],
 [28, 1.45],
 [29, 1.46],
 [30, 1.48],
 [31, 1.49],
 [32, 1.51],
 [33, 1.52],
 [34, 1.53],
 [35, 1.54],
 [36, 1.56],
 [37, 1.57],
 [38, 1.58],
 [39, 1.59],
 [40, 1.6],
 [41, 1.61],
 [42, 1.62],
 [43, 1.63],
 [44, 1.64],
 [45, 1.65],
 [46, 1.66],
 [47, 1.67],
 [48, 1.68],
 [49, 1.69],
 [50, 1.7],
 [51, 1.71],
 [52, 1.72],
 [53, 1.72],
 [54, 1.73],
 [55, 1.74],
 [56, 1.75],
 [57, 1.76],
 [58, 1.76],
 [59, 1.77],
 [60, 1.78],
 [61, 1.79],
 [62, 1.79],
 [63, 1.8],
 [64, 1.81],
 [65, 1.81],
 [66, 1.82],
 [67, 1.83],
 [68, 1.83],
 [69, 1.84],
 [70, 1.85],
 [71, 1.85],
 [72, 1.86],
 [73, 1.86],
 [74, 1.87],
 [75, 1.88],
 [76, 1.88],
 [77, 1.89],
 [78, 1.89],
 [79, 1.9],
 [80, 1.9],
 [81, 1.91],
 [82, 1.91],
 [83, 1.92],
 [84, 1.92],
 [85, 1.93],
 [86, 1.93],
 [87, 1.94],
 [88, 1.94],
 [89, 1.95],
 [90, 1.95],
 [91, 1.96],
 [92, 1.96],
 [93, 1.97],
 [94, 1.97],
 [95, 1.98],
 [96, 1.98],
 [97, 1.99],
 [98, 1.99],
 [99, 2],
 [100, 2],
 [101, 2],
 [102, 2.01],
 [103, 2.01],
 [104, 2.02],
 [105, 2.02],
 [106, 2.03],
 [107, 2.03],
 [108, 2.03],
 [109, 2.04],
 [110, 2.04],
 [111, 2.05],
 [112, 2.05],
 [113, 2.05],
 [114, 2.06],
 [115, 2.06],
 [116, 2.06],
 [117, 2.07],
 [118, 2.07],
 [119, 2.08],
 [120, 2.08],
 [121, 2.08],
 [122, 2.09],
 [123, 2.09],
 [124, 2.09],
 [125, 2.1],
 [126, 2.1],
 [127, 2.1],
 [128, 2.11],
 [129, 2.11],
 [130, 2.11],
 [131, 2.12],
 [132, 2.12],
 [133, 2.12],
 [134, 2.13],
 [135, 2.13],
 [136, 2.13],
 [137, 2.14],
 [138, 2.14],
 [139, 2.14],
 [140, 2.15],
 [141, 2.15],
 [142, 2.15],
 [143, 2.16],
 [144, 2.16],
 [145, 2.16],
 [146, 2.16],
 [147, 2.17],
 [148, 2.17],
 [149, 2.17],
 [150, 2.18],
 [151, 2.18],
 [152, 2.18],
 [153, 2.18],
 [154, 2.19],
 [155, 2.19],
 [156, 2.19],
 [157, 2.2],
 [158, 2.2],
 [159, 2.2],
 [160, 2.2],
 [161, 2.21],
 [162, 2.21],
 [163, 2.21],
 [164, 2.21],
 [165, 2.22],
 [166, 2.22],
 [167, 2.23],
 [168, 2.23],
 [169, 2.23],
 [170, 2.23],
 [171, 2.23],
 [172, 2.23],
 [173, 2.24],
 [174, 2.24],
 [175, 2.24],
 [176, 2.24],
 [177, 2.25],
 [178, 2.25],
 [179, 2.25],
 [180, 2.26],
 [181, 2.26],
 [182, 2.26],
 [183, 2.26],
 [184, 2.26],
 [185, 2.27],
 [186, 2.27],
 [187, 2.27],
 [188, 2.27],
 [189, 2.28],
 [190, 2.28],
 [191, 2.28],
 [192, 2.28],
 [193, 2.29],
 [194, 2.29],
 [195, 2.29],
 [196, 2.29],
 [197, 2.29],
 [198, 2.3],
 [199, 2.3],
 [200, 2.3],
 [201, 2.3],
 [202, 2.3],
 [203, 2.31],
 [204, 2.31],
 [205, 2.31],
 [206, 2.31],
 [207, 2.32],
 [208, 2.32],
 [209, 2.32],
 [210, 2.32],
 [220, 2.34],
 [230, 2.36],
 [240, 2.38],
 [250, 2.4],
 [260, 2.42],
 [270, 2.43],
 [280, 2.45],
 [290, 2.46],
 [300, 2.48],
 [310, 2.49],
 [320, 2.51],
 [330, 2.52],
 [340, 2.53],
 [350, 2.54],
 [360, 2.56],
 [370, 2.57],
 [380, 2.58],
 [390, 2.59],
 [400, 2.6],
 [410, 2.61],
 [420, 2.62],
 [430, 2.63],
 [440, 2.64],
 [450, 2.65],
 [460, 2.66],
 [470, 2.67],
 [480, 2.68],
 [490, 2.69],
 [500, 2.7],
 [510, 2.71],
 [520, 2.72],
 [530, 2.72],
 [540, 2.73],
 [550, 2.74],
 [560, 2.75],
 [570, 2.76],
 [580, 2.76],
 [590, 2.77],
 [600, 2.78],
 [610, 2.79],
 [620, 2.79],
 [630, 2.8],
 [640, 2.81],
 [650, 2.81],
 [660, 2.82],
 [670, 2.83],
 [680, 2.83],
 [690, 2.84],
 [700, 2.85],
 [710, 2.85],
 [720, 2.86],
 [730, 2.86],
 [740, 2.87],
 [750, 2.88],
 [760, 2.88],
 [770, 2.89],
 [780, 2.89],
 [790, 2.9],
 [800, 2.9],
 [810, 2.91],
 [820, 2.91],
 [830, 2.92],
 [840, 2.92],
 [850, 2.93],
 [860, 2.93],
 [870, 2.94],
 [880, 2.94],
 [890, 2.95],
 [900, 2.95],
 [910, 2.96],
 [920, 2.96],
 [930, 2.97],
 [940, 2.97],
 [950, 2.98],
 [960, 2.98],
 [970, 2.99],
 [980, 2.99],
 [990, 3]];


function vlookupApprox(val, table) {
  if (!Array.isArray(table) || table.length === 0) return null;
  for (let i = 0; i < table.length; i++) {
    if (val === table[i][0]) return table[i][1];
    if (val < table[i][0]) return i===0 ? table[0][1] : table[i-1][1];
  }
  return table[table.length-1][1];
}

// ✅ Auto-Fill TDS เมื่อกรอก conductivity
function updateAutoTDS() {
  const conduct = parseFloat(document.getElementById('conduct').value);
  const factor  = parseFloat(document.getElementById('factor').value);
  const tdsBox  = document.getElementById('tds');

  if (!Number.isNaN(conduct) && !Number.isNaN(factor)) {
    tdsBox.value = (conduct * factor).toFixed(0);
  } else {
    tdsBox.value = "";
  }
}


function calculateLSI() {
  const ph     = parseFloat(document.getElementById('ph').value);
  const conduct = parseFloat(document.getElementById('conduct').value);
  const tds     = parseFloat(document.getElementById('tds').value);
  const tempC  = parseFloat(document.getElementById('temp').value);
  const ca     = parseFloat(document.getElementById('ca').value);
  const alk    = parseFloat(document.getElementById('alk').value);

  const lsiValueEl = document.getElementById('lsiValue');
  const riValueEl  = document.getElementById('riValue');
  const interpEl   = document.getElementById('interp');

  if ([ph, conduct, tempC, ca, alk].some(v => Number.isNaN(v))) {
    lsiValueEl.textContent = "–";
    riValueEl.textContent  = "–";
    interpEl.textContent   = "";
    interpEl.className     = "interp";
    return;
  }

  const TDS = tds;

  const K5 = vlookupApprox(TDS, SOLIDS);
  const tempF = tempC * 1.8 + 32;
  const K6 = vlookupApprox(Math.round(tempF), TEMPERATURE);
  const K7 = vlookupApprox(ca, HARDNESS);
  const K8 = vlookupApprox(alk, ALKALINITY);

  const pHs = 9.3 + K5 + K6 - K7 - K8;
  const LSI = ph - pHs;
  const RI  = 2 * pHs - ph;

  lsiValueEl.textContent = LSI.toFixed(2);
  riValueEl.textContent  = RI.toFixed(2);

  lsiValueEl.style.color = LSI > 0 ? '#28a745' : '#d9534f';

  let interp = "";
  let cls = "interp";
  if (LSI > 0.5) {
    interp = "Scaling tendency (LSI > 0.5)";
    cls += " scaling";
  } else if (LSI >= -0.1) {
    interp = "Balanced (LSI -0.1 to 0.5)";
    cls += " balanced";
  } else {
    interp = "Corrosive tendency (LSI < -0.1)";
    cls += " corrosive";
  }

  interpEl.textContent = interp;
  interpEl.className = cls;
}

window.addEventListener('DOMContentLoaded', calculateLSI);
</script>

</body>
</html>
